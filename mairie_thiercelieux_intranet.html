<!DOCTYPE html>
<html lang='fr'>
<head>
<meta charset='UTF-8'>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<title>Thiercelieux - Information de la mairie</title>
<style>
  body { background-color: black; color: white; text-align: center; font-family: Arial, sans-serif; }
  input { width: 300px; height: 30px; font-size: 16px; padding: 5px; background-color: #222; color: white; border: 1px solid white; }
  button { font-size: 16px; padding: 10px; background-color: #333; color: white; border: 1px solid white; cursor: pointer; }
  button:hover { background-color: #555; }
  #message { font-size: 18px; font-weight: bold; margin-top: 10px; }
  .button-container { display: flex; justify-content: center; gap: 10px; margin-top: 20px; }
</style>
<script>
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('validateButton').disabled = true;
  function chargerJoueurs() {
    let cacheBuster = new Date().getTime();
    fetch('joueurs.json?t=' + cacheBuster, { cache: 'no-store' })
      .then(response => response.json())
      .then(players => { 
        window.joueursData = players;
        document.getElementById('validateButton').disabled = false;
      })
      .catch(error => {
        console.error('Erreur de chargement des joueurs :', error);
      });
  }
  document.getElementById('validateButton').addEventListener('click', function() {
    let joueurId = document.getElementById('joueurId').value;
    let password = document.getElementById('password').value;
    let messageElement = document.getElementById('message');
    if (!window.joueursData) {
      messageElement.innerText = 'Chargement en cours... Veuillez patienter.';
      messageElement.style.color = 'orange';
      return;
    }
    if (window.joueursData[joueurId] && window.joueursData[joueurId].password === password) {
      messageElement.innerText = window.joueursData[joueurId].info;
      messageElement.style.color = 'green';
      localStorage.setItem('joueurId', joueurId);
      localStorage.setItem('password', password);
    } else {
      messageElement.innerText = 'Numéro de joueur ou mot de passe incorrect.';
      messageElement.style.color = 'red';
    }
  });
  chargerJoueurs();
});
</script>
</head><body>
<h1>Intranet de la mairie de Thiercelieux</h1>
<input type='number' id='joueurId' placeholder='Numéro du joueur' /><br><br>
<input type='password' id='password' placeholder='Mot de passe' /><br><br>
<div class='button-container'>
<button id='validateButton'>Valider</button>
</div>
<div id='message'></div>
</body></html>